<div class="container-fluid px-0">
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-dark text-white d-flex justify-content-between align-items-center w-100">
      <h3 class="mb-0">School Comparison</h3>
      <span class="text-light"><%= params[:metric]&.titleize || 'Job Offer Rate' %></span>
    </div>
    <div class="card-body" style="height: 500px; padding: 20px;">
      <canvas id="schoolComparisonChart"></canvas>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const ctx = document.getElementById('schoolComparisonChart').getContext('2d');
  
  const initialData = <%= raw @filtered_data.to_json %>;

  window.myChart = new Chart(ctx, {
    type: 'bar',
    data: initialData,
    options: {
      indexAxis: 'y',
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          display: false  // Remove legend
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          grid: {
            display: false
          },
          ticks: {
            font: {
              size: 13
            }
          }
        },
        x: {
          beginAtZero: true,
          grid: {
            color: '#f0f0f0'
          },
          min: 0,
          max: 100,
          ticks: {
            font: {
              size: 12
            },
            callback: function(value) {
              return value + '%';
            }
          }
        }
      }
    }
  });
});
</script>

<%= content_for :javascript do %>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Chart.js initialization for industry breakdown
      const industryCtx = document.getElementById('industryChart').getContext('2d');
      new Chart(industryCtx, {
          type: 'pie',
          data: {
              labels: ['Consulting', 'Finance', 'Technology', 'Other'],
              datasets: [{
                  data: [35, 25, 20, 20],
                  backgroundColor: [
                      '#007bff',
                      '#28a745',
                      '#ffc107',
                      '#dc3545'
                  ]
              }]
          }
      });

      // Chart.js initialization for geographic distribution
      const geoCtx = document.getElementById('geographyChart').getContext('2d');
      new Chart(geoCtx, {
          type: 'pie',
          data: {
              labels: ['Northeast US', 'West Coast', 'International', 'Other US'],
              datasets: [{
                  data: [45, 30, 15, 10],
                  backgroundColor: [
                      '#007bff',
                      '#28a745',
                      '#ffc107',
                      '#dc3545'
                  ]
              }]
          }
      });
    });
  </script>

  <%= content_for :head do %>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>
  <% end %>
<% end %> 
